# Задание T2: Написание баг-репорта

---

## **1. Анализ требований**

### **Найденные проблемы:**

#### **1.1 Неоднозначность в описании поиска**
**Требование:** "Поле поиска принимает любые буквы/цифры/символы"  
**Проблема:** Не определено, что значит "любые символы". Неясно, как система должна обрабатывать спецсимволы, эмодзи, непечатаемые символы.

#### **1.2 Противоречие с реальной логикой**
**Требование:** "Если файл находится в корзине - он так же может быть найден поиском"  
**Проблема:** В реальных файловых системах файлы в корзине обычно скрыты от обычного поиска. Требование либо нереалистично, либо требует нестандартной реализации.

#### **1.3 Неполнота требований к API**
**Требование:** "Если какие-то данные некорректны - ответ 400"  
**Проблема:** Не указано, что считается "некорректными данными". Отсутствуют граничные значения, ограничения длины, допустимые символы.

---

## **2. Тестирование UI Яндекс.Диска**

### **2.1 Подготовка тестовой среды:**
- Браузер: Chrome версия 143.0.7499.41
- ОС: Windows 10
- Учётная запись Яндекс: создана специально для тестирования
- Тестовые данные созданы: файл `test_search_file.txt`, папка `Test_Folder_SDET`

### **2.2 Результаты тестов:**

#### **Тест UI-01: Поиск существующего файла**
- **Шаги:** Ввела "test_search_file" в поле поиска → Enter
- **Ожидаемый результат:** Файл найден
- **Фактический результат:** Файл найден за ~1-2 секунды
- **Скриншот:** [search_found.png](./search_found.png)
- **Статус:** Успешно

#### **Тест UI-02: Поиск файла в корзине**
- **Шаги:**
  1. Удалила файл `test_search_file.txt`
  2. Проверила корзину - файл присутствует
  3. Выполнила обычный поиск по "test_search_file"
  4. Система предложила "Искать в корзине"
  5. Выполнила поиск в корзине → файл найден
- **Анализ:**
  - Обычный поиск не находит файлы в корзине
  - Система предлагает переключиться на поиск в корзине
  - В поиске по корзине файл успешно находится
- **Скриншоты:**
  - [search_not_found.png](./search_not_found.png) - обычный поиск не нашёл файл
  - [search_trash_found.png](./search_trash_found.png) - поиск в корзине нашёл файл
  - [trash_content.png](./trash_content.png) - подтверждение наличия файла в корзине
- **Статус:** Частичное соответствие требованиям

#### **Тест UI-03: Пустой поиск**
- **Шаги:** Очистила поле поиска → Enter
- **Ожидаемый результат:** Не определено в требованиях
- **Фактический результат:** Ничего не произошло (система проигнорировала пустой запрос)
- **Скриншот:** [empty_search.png](./empty_search.png)
- **Статус:** Требует уточнения требований

### **2.3 Выводы по UI:**
1.  Основной поиск работает корректно
2.  Реализация поиска в корзине отличается от буквального прочтения требований
3.  Поведение при пустом поиске не определено

---

## **3. Тестирование API Яндекс.Диска**

### **3.1 Подготовка тестовой среды:**
- **Инструмент:** Postman v11.40.0
- **OAuth-токен Яндекс.Диска:** получен через Яндекс.OAuth
- **Базовый URL:** `https://cloud-api.yandex.net/v1/disk`
- **Заголовки запросов:**
  - Content-Type: application/json
  - Authorization: OAuth [полученный_токен]

### **3.2 Результаты тестирования API:**

#### **Тест API-01: Успешное создание папки**
- **Шаги:**
  1. Отправила PUT запрос на `/disk/resources` с параметром `path=/test_folder_postman_001`
  2. В заголовках указала валидный OAuth-токен
  3. Зафиксировала ответ сервера
- **Ожидаемый результат:** 200 OK (как указано в требованиях)
- **Фактический результат:** 201 Created с ссылкой на созданный ресурс
- **Анализ:** API возвращает код 201 Created, который является более семантически правильным для операции создания ресурса в REST API. Однако это **формальное несоответствие требованиям**, где указан ожидаемый код 200.
- **Пример ответа:**
```json
{
    "method": "GET",
    "href": "https://cloud-api.yandex.net/v1/disk/resources?path=disk%3A%2Ftest_folder_postman_001",
    "templated": false
}
```
- **Скриншот:** [api_01_create_latin_201.png](./api_01_create_latin_201.png)
- **Статус:** Функциональность работает, но с расхождением по коду ответа

#### **Тест API-02: Создание существующей папки**
- **Шаги:**
  1. Отправила тот же PUT запрос еще раз с тем же путем
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 400 Bad Request
- **Фактический результат:** 409 Conflict 
- Пример ответа:
```json
{
    "error": "DiskPathPointsToExistentDirectoryError",
    "description": "Specified path \"/test_folder_postman_001\" points to existent directory.",
    "message": "По указанному пути \"/test_folder_postman_001\" уже существует папка с таким именем."
}
```
- **Скриншот:** [api_02_conflict_409.png](./api_02_conflict_409.png)
- **Анализ:** API возвращает 409 вместо 400, что является более специфичным кодом ошибки
- **Статус:** Расхождение с требованиями

#### **Тест API-03: Создание без авторизации**
- **Шаги:**
  1. Отправила PUT запрос без заголовка Authorization
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 401 Unauthorized
- **Фактический результат:** 401 Unauthorized
- Пример ответа:
```json
{
    "error": "UnauthorizedError",
    "description": "Unauthorized",
    "message": "Не авторизован."
}
```
- **Скриншот:** [api_03_unauthorized_401.png](./api_03_unauthorized_401.png)
- **Статус:** Пройден

#### **Тест API-04: Создание с некорректным путем**
- **Шаги:**
  1. Отправила PUT запрос с путем `/invalid//path\format`
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 400 Bad Request
- **Фактический результат:** ️ 404 Not Found
- Пример ответа:
```json
{
    "error": "DiskNotFoundError",
    "description": "Resource not found.",
    "message": "Не удалось найти запрошенный ресурс."
}
```
- **Скриншот:** [api_04_not_found_404.png](./api_04_not_found_404.png)
- **Анализ:** API интерпретирует некорректный путь как попытку создать папку в несуществующем каталоге
- **Статус:** Расхождение с требованиями

#### **Тест API-05: Создание папки с кириллицей**
- **Шаги:**
  1. Отправила PUT запрос с путем `/тестовая_папка`
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 200 OK
- **Фактический результат:** 201 Created
- Пример ответа:
```json
{
"method": "GET",
"href": "https://cloud-api.yandex.net/v1/disk/resources?path=disk%3A%2F%D1%82%D0%B5%D1%81%D1%82%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BF%D0%B0%D0%BF%D0%BA%D0%B0",
"templated": false
}
```
- **Скриншот:** [api_05_create_cyrillic_201.png](./api_05_create_cyrillic_201.png)
- **Анализ:** Путь автоматически URL-кодируется, папка успешно создается, но с кодом 201 вместо ожидаемого 200
- **Статус:** Частичное соответствие (функционально - успех, по коду - расхождение)

#### **Тест API-06: Верификация создания папки (GET запрос для проверки)**
- **Цель теста:** Проверить, что папка действительно создана и доступна в системе (верификация успешного создания из API-01 и API-05)
- **Шаги:**
  1. Отправила GET запрос на `/disk/resources` с путем созданных папок
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 200 OK с информацией о папке
- **Фактический результат:** 200 OK
- Пример ответа для папки **test_folder_postman_001**:
```json
{
    "path": "disk:/test_folder_postman_001",
    "type": "dir",
    "name": "test_folder_postman_001",
    "created": "2025-12-14T15:09:46+00:00",
    "modified": "2025-12-14T15:09:46+00:00",
    "_embedded": {
        "path": "disk:/test_folder_postman_001",
        "limit": 20,
        "offset": 0,
        "sort": "",
        "total": 0,
        "items": []
    },
    "resource_id": "907367583:c0e8faf8c346033e96dc191e4bf3a9d221f35cc29bb8a3e7099d8fc2fe0d7119",
    "revision": 1765724986824110,
    "comment_ids": {
        "public_resource": "907367583:c0e8faf8c346033e96dc191e4bf3a9d221f35cc29bb8a3e7099d8fc2fe0d7119",
        "private_resource": "907367583:c0e8faf8c346033e96dc191e4bf3a9d221f35cc29bb8a3e7099d8fc2fe0d7119"
    },
    "exif": {}
}
```
- Пример ответа для папки **тестовая_папка**:
```json
{
    "path": "disk:/тестовая_папка",
    "type": "dir",
    "name": "тестовая_папка",
    "created": "2025-12-14T15:13:52+00:00",
    "modified": "2025-12-14T15:13:52+00:00",
    "_embedded": {
        "path": "disk:/тестовая_папка",
        "limit": 20,
        "offset": 0,
        "sort": "",
        "total": 0,
        "items": []
    },
    "resource_id": "907367583:4df250f2f582fdc8e7fb2a191c9ce7b9e027da8747e215352085324e42428b2a",
    "revision": 1765725232886468,
    "comment_ids": {
        "public_resource": "907367583:4df250f2f582fdc8e7fb2a191c9ce7b9e027da8747e215352085324e42428b2a",
        "private_resource": "907367583:4df250f2f582fdc8e7fb2a191c9ce7b9e027da8747e215352085324e42428b2a"
    },
    "exif": {}
}
```
- **Скриншоты:** 
  - [api_06_get_latin_200.png](./api_06_get_latin_200.png) - получение информации о **test_folder_postman_001**
  - [api_06_get_cyrillic_200.png](./api_06_get_cyrillic_200.png) - получение информации о **тестовая_папка**
- **Статус:** Пройден

#### **Тест API-07: Очистка тестовых данных**
- **Цель теста:** Удалить созданные тестовые данные для поддержания чистоты тестовой среды
- **Шаги:**
  1. Отправила DELETE запрос на `/disk/resources` с путем созданных папок
  2. Зафиксировала ответ сервера
- **Ожидаемый результат:** 204 No Content
- **Фактический результат:** 204 No Content
- **Скриншоты:**
  - [api_07_delete_latin_204.png](./api_07_delete_latin_204.png) - успешное удаление **test_folder_postman_001**
  - [api_07_get_latin_404.png](./api_07_get_latin_404.png) - проверка отсутствия **test_folder_postman_001**
  - [api_07_delete_cyrillic_204.png](./api_07_delete_cyrillic_204.png) - успешное удаление **тестовая_папка**
  - [api_07_get_cyrillic_404.png](./api_07_get_cyrillic_404.png) - проверка отсутствия **тестовая_папка**
- **Проверка:** Повторный GET запрос возвращает 404
- **Скриншоты:**
  - [api_07_delete_latin_again_404.png](./api_07_delete_latin_again_404.png) - повторное удаление **test_folder_postman_001**
  - [api_07_delete_cyrillic_again_404.png](./api_07_delete_cyrillic_again_404.png) - повторное удаление **тестовая_папка**
- **Статус:** Пройден

### **3.3 Выводы по API:**
1.  **CRUD операции работают корректно** - создание, чтение, удаление папок выполняется успешно
2.  **Коды ошибок отличаются от требований:**
  - Успешное создание папки: 201 Created вместо 200 OK
  - Создание существующей папки: 409 Conflict вместо 400 Bad Request
  - Некорректный путь: 404 Not Found вместо 400 Bad Request
3.  **Авторизация работает строго** - без токена возвращается 401
4.  **Поддержка Unicode** - кириллические имена обрабатываются корректно
5.  **Идемпотентность PUT** - повторный запрос не создает дубликаты
6.  **Информативные ошибки** - ответы содержат детальное описание проблем
7. Семантическая корректность - API использует более специфичные HTTP-коды (201, 409), что соответствует лучшим практикам REST

---

## **4. БАГ-РЕПОРТЫ**

### **Баг-репорт YD-SEARCH-001:**
**ID:** YD-SEARCH-001  
**Заголовок:** Несоответствие реализации поиска в корзине требованиям  
**Требование:** "Если файл находится в корзине - он так же может быть найден поиском"  
**Реальность:** Обычный поиск не находит файлы в корзине, требуется специальный поиск в корзине
**Серьёзность:** Несоответствие  
**Приоритет:** Средний
**Окружение:** Chrome 143.0.7499.41, Windows 10, Яндекс.Диск (веб-версия) 

**Шаги воспроизведения:**
1. Создать файл с уникальным именем (например, test_search_file.txt)
2. Поместить файл в корзину через интерфейс Яндекс.Диска
3. В поле поиска ввести имя файла
4. Нажать Enter или кнопку поиска

**Ожидаемый результат:** Файл найден в результатах поиска 
**Фактический результат:** Файл не найден, система предлагает "Искать в корзине"
**Скриншоты:**
- [search_not_found.png](./search_not_found.png) - обычный поиск не нашёл файл
- [search_trash_found.png](./search_trash_found.png) - поиск в корзине нашёл файл
- [trash_content.png](./trash_content.png) - подтверждение наличия файла в корзине
**Статус:** **БАГ-РЕПОРТ ОФОРМЛЕН**

### **Баг-репорт YD-API-001:**
**ID:** YD-API-001 
**Заголовок:** Несоответствие кода ответа при создании существующей папки  
**Требование:** "При попытке создания уже по существующему пути - ответ 400"  
**Реальность:** API возвращает 409 Conflict вместо 400 Bad Request
**Серьёзность:** Несоответствие
**Приоритет:** Низкий  
**Окружение:** Postman v11.40.0, Яндекс.Диск API v1

**Шаги воспроизведения:**

1. Отправить PUT запрос на https://cloud-api.yandex.net/v1/disk/resources с параметром path=/любой_валидный_путь и валидным заголовком Authorization 
2. Убедиться, что папка создана (получен код 201)
3. Повторить точно такой же запрос

**Ожидаемый результат:** 400 Bad Request
**Фактический результат:** 409 Conflict с сообщением "Resource already exists"
**Скриншот:** [api_02_conflict_409.png](./api_02_conflict_409.png)
**Статус:** **БАГ-РЕПОРТ ОФОРМЛЕН**

### **Баг-репорт YD-API-002:**
**ID:** YD-API-002
**Заголовок:** Несоответствие кода ответа при успешном создании папки
**Требование:** "В случае успешного выполнения запроса получен ответ 200"
**Реальность:** API возвращает 201 Created
**Серьёзность:** Незначительный (Minor)
**Приоритет:** Низкий
**Окружение:** Postman v11.40.0, Яндекс.Диск API v1

**Шаги воспроизведения:**

1. Отправить PUT запрос на https://cloud-api.yandex.net/v1/disk/resources с параметром path=/new_test_folder и валидным заголовком Authorization 
2. Зафиксировать код ответа сервера

**Ожидаемый результат:** 200 OK
**Фактический результат:** 201 Created
**Примечание:** Код 201 Created семантически более корректен для операции создания ресурса в REST API, но формально не соответствует требованиям
**Скриншоты:**
- [api_01_create_latin_201.png](./api_01_create_latin_201.png) - создание **test_folder_postman_001**
- [api_05_create_cyrillic_201.png](./api_05_create_cyrillic_201.png) - создание **тестовая_папка**
**Статус:** **БАГ-РЕПОРТ ОФОРМЛЕН**

### **Рекомендация YD-UX-001:**
**ID:** YD-UX-001
**Заголовок:** Отсутствие реакции на пустой поисковый запрос  
**Требование:** Не определено  
**Реальность:** Система игнорирует пустой запрос  
**Статус:** **РЕКОМЕНДАЦИЯ (не баг)**  
**Скриншот:** [empty_search.png](./empty_search.png)
**Предложение:** Добавить поведение для пустого поиска в требования

---
